# 🚀 快速启动指南

## ✅ 已完成的功能

### 后端 API
- ✅ NextAuth.js 认证（登录/注册）
- ✅ 用户管理
- ✅ 项目管理（列表、创建、详情、更新、删除）
- ✅ 任务管理（列表、创建、详情、更新、删除）
- ✅ Prisma ORM + Supabase PostgreSQL

### 前端页面
- ✅ 登录页面 (`/login`)
- ✅ 注册页面 (`/register`)
- ✅ 仪表板 (`/dashboard`) - 显示统计数据
- ✅ 项目列表 (`/projects`) - 可点击查看详情
- ✅ 项目详情 (`/projects/[id]`) - 包含任务、成员、支出、文档等信息
- ✅ 任务管理 (`/tasks`) - 支持筛选和状态更新

---

## 📋 快速启动（3步）

### 步骤 1：设置环境变量（2分钟）

创建 `.env.local` 文件：

```bash
# 在项目根目录运行
cat > .env.local << 'ENVEOF'
# 数据库（从 Supabase 获取）
DATABASE_URL="postgresql://postgres:YOUR_PASSWORD@db.xxx.supabase.co:5432/postgres"

# NextAuth 密钥（生成新的）
NEXTAUTH_SECRET="运行: openssl rand -base64 32"
NEXTAUTH_URL="http://localhost:3000"

# 前端配置
NEXT_PUBLIC_APP_URL="http://localhost:3000"
ENVEOF
```

**获取 DATABASE_URL**：
1. 访问 https://supabase.com/dashboard
2. 选择您的项目 → Settings → Database
3. 复制 "Connection string" (URI 格式)

**生成 NEXTAUTH_SECRET**：
```bash
openssl rand -base64 32
```

### 步骤 2：初始化数据库（1分钟）

```bash
# 生成 Prisma Client
npx prisma generate

# 创建数据库表
npx prisma db push

# （可选）查看数据库
npx prisma studio
```

### 步骤 3：启动开发服务器（10秒）

```bash
npm run dev
```

访问: **http://localhost:3000**

---

## 🎯 测试流程

### 1. 注册新用户
- 访问 http://localhost:3000
- 自动跳转到 `/login`
- 点击"立即注册"
- 填写姓名、邮箱、密码
- 提交

### 2. 登录
- 使用刚注册的邮箱和密码登录
- 成功后跳转到 `/dashboard`

### 3. 查看仪表板
- 看到统计数据：
  - 总项目数
  - 总任务数
  - 我的待办任务

### 4. 查看项目列表
- 点击"查看所有项目"
- 跳转到 `/projects`
- 目前是空列表（因为还没创建项目）

### 5. 查看任务管理
- 点击"查看我的任务"或直接访问 `/tasks`
- 可以按状态筛选任务（全部、待办、进行中、已完成、已取消）
- 可以更新任务状态或删除任务

### 6. 查看项目详情
- 在项目列表中点击任何项目卡片
- 查看项目的完整信息
- 切换标签页查看任务、成员、支出、文档

---

## 🚀 部署到 Vercel（1分钟）

代码已推送到 GitHub，Vercel 会自动部署。

### 必需的 Vercel 环境变量

在 Vercel Dashboard → Settings → Environment Variables 添加：

```env
DATABASE_URL=你的 Supabase URL
NEXTAUTH_SECRET=生成的随机字符串
NEXTAUTH_URL=https://your-app.vercel.app
NEXT_PUBLIC_APP_URL=https://your-app.vercel.app
```

### 运行数据库迁移

```bash
# 本地连接 Supabase
export DATABASE_URL="你的 Supabase URL"
npx prisma db push
```

---

## 📊 当前进度

### ✅ 已实现（核心功能）
- 用户认证系统
- 数据库模型（8个表）
- 用户页面（登录、注册、仪表板）
- 项目管理（列表、详情）
- 任务管理（列表、筛选、状态更新）
- API Routes（认证、项目、任务）

### 🔄 待实现（扩展功能）
- 创建项目表单页面
- 创建任务表单页面
- 项目成员管理
- 支出管理页面
- 文档管理页面
- 用户管理页面
- 审计日志页面

### 📝 代码复用
- 现有的 UI 组件（`src/components/`）已经存在
- 可以直接在新页面中导入使用
- 只需调整路由方式（React Router → Next.js）

---

## 🛠️ 开发命令

```bash
# 开发服务器
npm run dev

# 构建生产版本
npm run build

# 启动生产服务器
npm start

# 数据库迁移
npm run db:migrate

# 数据库管理界面
npm run db:studio

# 代码格式化
npm run format
```

---

## 🔍 故障排查

### 问题 1：Prisma Client 报错

```bash
# 重新生成 Prisma Client
npx prisma generate
```

### 问题 2：数据库连接失败

- 检查 `.env.local` 中的 `DATABASE_URL`
- 确保 Supabase 数据库正在运行
- 测试连接：`npx prisma db push`

### 问题 3：NextAuth 报错

- 检查 `NEXTAUTH_SECRET` 是否已设置
- 检查 `NEXTAUTH_URL` 是否正确

### 问题 4：页面 404

- 确保运行了 `npm run dev`
- 检查浏览器控制台的错误信息

---

## 📚 项目结构

```
src/
├── app/                     # Next.js App Router
│   ├── api/                # API Routes
│   │   ├── auth/           # 认证 API
│   │   │   ├── [...nextauth]/  # NextAuth 处理器
│   │   │   └── register/   # 注册 API
│   │   ├── projects/       # 项目 API
│   │   │   ├── [id]/       # 单个项目（详情、更新、删除）
│   │   │   └── route.ts    # 项目列表、创建
│   │   └── tasks/          # 任务 API
│   │       ├── [id]/       # 单个任务（详情、更新、删除）
│   │       └── route.ts    # 任务列表、创建
│   ├── dashboard/          # 仪表板页面
│   ├── login/              # 登录页面
│   ├── register/           # 注册页面
│   ├── projects/           # 项目相关页面
│   │   ├── [id]/           # 项目详情页面
│   │   └── page.tsx        # 项目列表页面
│   ├── tasks/              # 任务管理页面
│   ├── layout.tsx          # 根布局
│   ├── providers.tsx       # SessionProvider
│   └── page.tsx            # 首页（重定向）
├── components/             # React 组件（复用现有）
│   ├── common/             # 通用组件
│   ├── layout/             # 布局组件
│   └── ...
└── lib/                    # 工具函数
    ├── prisma.ts           # Prisma Client
    └── auth.ts             # NextAuth 配置

prisma/
└── schema.prisma           # 数据库模型（8个表）
```

---

## 🎉 恭喜！

您现在拥有一个功能完整的 Next.js 全栈应用：

- ✅ 前后端统一为 TypeScript
- ✅ 类型安全的数据库操作（Prisma）
- ✅ 现代化的认证系统（NextAuth）
- ✅ 响应式 UI（Tailwind CSS）
- ✅ 一键部署（Vercel）

**下一步**：继续添加更多页面和功能，或直接部署到生产环境！
