# Feature Specification: 用户体验拯救项目群管理系统

**Feature Branch**: `001-ux-rescue-pm-system`
**Created**: 2025-10-21
**Status**: Draft
**Input**: User description: "web app项目管理软件,管理'用户体验拯救'项目群,包含项目看板、人员系统、仪表盘、单项目看板、预算体系"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 项目群总览和导航 (Priority: P1)

作为项目群管理员,我需要在一个中央仪表盘上查看"用户体验拯救"项目群下所有项目的整体状态,以便快速了解项目群的健康状况和关键指标。

**Why this priority**: 这是系统的核心价值主张 - 为项目群提供统一的视图。没有这个功能,系统就失去了存在意义。这是最小可行产品(MVP)的基础。

**Independent Test**: 管理员登录后能看到仪表盘,显示所有项目的数量、状态分布、总预算使用率等关键指标,并能点击进入项目看板。

**Acceptance Scenarios**:

1. **Given** 管理员已登录系统, **When** 进入仪表盘页面, **Then** 显示项目群总览,包括:项目总数、各状态项目数量、总预算和总花费、逾期项目数量
2. **Given** 仪表盘显示了10个项目, **When** 点击"查看所有项目"按钮, **Then** 进入项目看板页面,显示所有项目的卡片视图
3. **Given** 仪表盘显示预算超支预警, **When** 查看预算部分, **Then** 能识别哪些项目超支并显示超支金额

---

### User Story 2 - 项目创建和管理 (Priority: P1)

作为项目群管理员,我需要创建新项目、设置基本信息(名称、描述、预算、日期、状态)并分配项目成员,以便启动和管理项目群中的各个项目。

**Why this priority**: 项目是系统管理的核心对象。如果不能创建和管理项目,其他功能都无法使用。这是MVP的必要组成部分。

**Independent Test**: 管理员能够创建一个新项目,填写完整信息,保存后在项目看板上看到新项目,并能编辑或删除项目。

**Acceptance Scenarios**:

1. **Given** 管理员在项目看板页面, **When** 点击"创建项目"按钮并填写项目名称、描述、预算、开始日期、计划完成日期, **Then** 项目创建成功并出现在项目看板上,状态为"计划中"
2. **Given** 项目已创建, **When** 管理员编辑项目状态从"计划中"改为"进行中", **Then** 项目状态更新,且操作记录在操作日志中
3. **Given** 项目的计划完成日期已过,状态未标记为"已完成", **When** 系统检查日期, **Then** 项目标记为"逾期",并在仪表盘上显示逾期警告
4. **Given** 项目已创建, **When** 管理员为项目分配成员(从人员列表中选择), **Then** 被分配的成员能够查看该项目并管理其下的任务
5. **Given** 管理员在单项目看板页面, **When** 添加飞书文档链接(输入文档链接URL和标题), **Then** 文档链接关联到项目并在项目详情页显示,点击链接可在新标签页打开飞书文档

---

### User Story 3 - 任务管理 (Priority: P2)

作为项目成员,我需要在项目下创建任务、设置任务负责人和截止日期,并跟踪任务状态,以便细化项目工作并监控进度。

**Why this priority**: 任务管理是项目执行层面的核心功能。虽然项目级别的管理已经可以运作(P1),但任务级别的细化管理对于实际工作分配至关重要。

**Independent Test**: 在一个已存在的项目中,成员能够创建任务、分配给特定负责人、设置截止日期,并更新任务状态。任务负责人能看到分配给自己的任务并更新状态。

**Acceptance Scenarios**:

1. **Given** 管理员或成员在单项目看板页面, **When** 点击"添加任务"并填写任务名称、描述、截止日期、负责人, **Then** 任务创建成功并显示在项目的任务列表中,状态为"待办"
2. **Given** 任务已分配给某位任务负责人, **When** 该负责人登录系统并查看"我的任务", **Then** 能看到所有分配给自己的任务
3. **Given** 任务负责人查看自己的任务, **When** 更新任务状态为"进行中", **Then** 任务状态更新,且操作记录在日志中
4. **Given** 任务的截止日期已过,状态未标记为"已完成", **When** 系统检查日期, **Then** 任务标记为"逾期",并在单项目看板上显示逾期标识
5. **Given** 任务负责人在任务详情页, **When** 添加飞书文档链接(输入文档链接URL和标题), **Then** 文档链接关联到任务并显示在任务详情中,点击链接可在新标签页打开飞书文档

---

### User Story 4 - 预算跟踪 (Priority: P2)

作为项目群管理员,我需要为每个项目设置预算、记录实际花费并查看预算使用情况,以便控制项目群的财务支出。

**Why this priority**: 预算管理是项目群管理的关键维度。虽然可以在没有预算功能的情况下管理项目(P1已提供基础),但预算跟踪对于一年期的大型项目群至关重要。

**Independent Test**: 管理员能够为项目设置预算总额,手动记录花费条目,系统自动计算预算使用率和剩余金额,并在超支时显示预警。

**Acceptance Scenarios**:

1. **Given** 管理员在创建或编辑项目时, **When** 设置项目预算为100,000元, **Then** 项目的预算信息保存,且预算使用率显示为0%(未有花费)
2. **Given** 项目已设置预算, **When** 管理员添加花费记录(金额30,000元、说明"设备采购"), **Then** 实际花费更新为30,000元,预算使用率显示为30%,剩余预算70,000元
3. **Given** 项目预算100,000元,实际花费已达到110,000元, **When** 查看项目预算信息, **Then** 显示超支预警,超支金额10,000元(10%)
4. **Given** 多个项目都有预算和花费, **When** 管理员查看仪表盘, **Then** 显示项目群总预算、总花费和整体预算使用率

---

### User Story 5 - 人员和权限管理 (Priority: P3)

作为项目群总负责人,我需要添加和管理系统用户、分配角色(管理员/成员)并查看用户的操作日志,以便控制系统访问权限和追踪操作历史。

**Why this priority**: 人员管理是重要的支撑功能,但可以在早期版本中手动管理较少的用户。随着项目群规模扩大,系统化的人员管理变得更加重要。

**Independent Test**: 总负责人能够添加新用户、设置其角色(管理员或成员)、查看所有用户列表,并访问操作日志查看特定用户的历史操作。

**Acceptance Scenarios**:

1. **Given** 总负责人在用户管理页面, **When** 添加新用户(输入姓名、邮箱、角色), **Then** 用户创建成功并出现在用户列表中
2. **Given** 用户已创建,角色为"成员", **When** 该用户登录系统, **Then** 用户能查看所有项目和任务,但只能编辑分配给自己的任务,不能删除项目
3. **Given** 用户已创建,角色为"管理员", **When** 该用户登录系统, **Then** 用户拥有所有权限,能创建/编辑/删除项目、管理预算、管理用户
4. **Given** 系统记录了所有用户操作, **When** 管理员查看操作日志, **Then** 能看到操作时间、操作人、操作类型(创建/编辑/删除)、操作对象(项目/任务)的完整记录
5. **Given** 管理员查看操作日志, **When** 筛选特定用户的操作, **Then** 只显示该用户的操作历史

---

### Edge Cases

- **并发编辑**: 两个管理员同时编辑同一个项目时,后保存的覆盖先保存的(简单的"最后写入胜出"策略)
- **删除项目**: 删除项目时,其下所有任务和关联的文档链接也被删除(需要确认对话框警告)
- **删除任务**: 删除任务时,其关联的文档链接也被删除
- **用户移除**: 当移除一个用户时,该用户负责的任务不自动删除,但负责人字段清空并需要重新分配
- **日期逾期**: 系统每日检查一次所有项目和任务的日期,标记逾期项
- **预算为零**: 允许项目预算为0(表示该项目不涉及资金)
- **角色变更**: 当管理员降级为成员时,立即生效,该用户失去管理权限
- **大量数据**: 系统设计应支持至少100个项目,每个项目50个任务(5000个任务总量)
- **文档链接验证**: 系统应验证输入的URL是否为有效的飞书文档链接格式(包含feishu.cn或larksuite.com域名)
- **多个文档链接**: 一个项目或任务可以关联多个文档链接(无数量限制)

## Requirements *(mandatory)*

### Functional Requirements

**用户认证和授权**
- **FR-001**: 系统必须支持用户登录功能,使用邮箱和密码进行身份验证
- **FR-002**: 系统必须区分两种角色:管理员(完全权限)和成员(受限权限)
- **FR-003**: 管理员必须能够创建、编辑、删除项目、任务、用户和预算信息
- **FR-004**: 成员必须能够查看所有项目和任务,但只能编辑分配给自己的任务
- **FR-005**: 系统必须记录所有用户操作(创建、编辑、删除)到操作日志,包含时间戳、操作人、操作类型、操作对象

**项目管理**
- **FR-006**: 系统必须支持创建项目,包含以下字段:项目名称(必填)、描述、预算金额、开始日期、计划完成日期、状态
- **FR-007**: 项目状态必须支持四种状态:计划中、进行中、已完成、已归档
- **FR-008**: 系统必须支持编辑和删除项目(删除需确认)
- **FR-009**: 删除项目时,系统必须同时删除该项目下的所有任务
- **FR-010**: 系统必须支持为项目分配成员(从用户列表中多选)
- **FR-011**: 系统必须在项目计划完成日期过后且状态未标记为"已完成"或"已归档"时,自动标记项目为"逾期"

**任务管理**
- **FR-012**: 系统必须支持在项目下创建任务,包含:任务名称(必填)、描述、截止日期(可选)、负责人(从项目成员中选择)、状态
- **FR-013**: 任务状态必须支持三种状态:待办、进行中、已完成
- **FR-014**: 系统必须支持编辑和删除任务
- **FR-015**: 任务负责人必须能够更新自己负责的任务状态
- **FR-016**: 系统必须在任务截止日期过后且状态未标记为"已完成"时,自动标记任务为"逾期"
- **FR-017**: 系统必须提供"我的任务"视图,显示当前用户作为负责人的所有任务

**预算管理**
- **FR-018**: 系统必须允许为项目设置预算总额(可以为0,表示无资金项目)
- **FR-019**: 系统必须支持手动添加花费记录,包含:金额(必填)、说明(可选)、记录时间(自动)
- **FR-020**: 系统必须自动计算并显示:实际总花费、预算使用率(百分比)、剩余预算
- **FR-021**: 当实际花费超过预算时,系统必须显示超支预警和超支金额
- **FR-022**: 系统必须在项目详情页显示该项目的完整花费记录列表

**仪表盘和看板**
- **FR-023**: 系统必须提供项目群仪表盘,显示:项目总数、各状态项目数量、总预算、总花费、预算使用率、逾期项目数量
- **FR-024**: 系统必须提供项目看板页面,以卡片形式展示所有项目,每个卡片显示:项目名称、状态、预算使用率、逾期标识(如适用)
- **FR-025**: 系统必须提供单项目看板页面,显示:项目详细信息、任务列表(按状态分组)、预算详情、项目成员列表
- **FR-026**: 用户必须能够从仪表盘导航到项目看板,从项目看板导航到单项目看板

**人员管理**
- **FR-027**: 管理员必须能够添加新用户,包含:姓名(必填)、邮箱(必填,唯一)、角色(管理员/成员)、密码(初始密码)
- **FR-028**: 管理员必须能够编辑用户信息(姓名、角色)和删除用户
- **FR-029**: 删除用户时,该用户负责的任务负责人字段必须清空
- **FR-030**: 系统必须提供用户列表页面,显示所有用户的姓名、邮箱、角色

**操作日志**
- **FR-031**: 系统必须记录以下操作类型:创建项目、编辑项目、删除项目、创建任务、编辑任务、删除任务、添加花费记录、创建用户、编辑用户、删除用户、添加文档链接、删除文档链接
- **FR-032**: 每条操作日志必须包含:操作时间(精确到秒)、操作人(用户姓名)、操作类型、操作对象(如"项目:用户体验调研")
- **FR-033**: 管理员必须能够查看完整的操作日志,并能按用户、操作类型、时间范围进行筛选

**文档管理**
- **FR-034**: 管理员和项目成员必须能够为项目添加飞书文档链接,包含:文档URL(必填)、文档标题(可选,默认显示"相关文档")
- **FR-035**: 任务负责人必须能够为自己负责的任务添加飞书文档链接,包含:文档URL(必填)、文档标题(可选)
- **FR-036**: 系统必须验证文档URL是否为有效的飞书文档链接(包含feishu.cn或larksuite.com域名),无效链接不允许保存
- **FR-037**: 系统必须在项目详情页和任务详情页显示所有关联的文档链接,点击链接在新标签页打开
- **FR-038**: 管理员和文档添加人必须能够删除文档链接
- **FR-039**: 删除项目或任务时,系统必须同时删除其关联的所有文档链接

### Key Entities

- **用户(User)**: 代表系统使用者,包含姓名、邮箱(唯一标识)、角色(管理员/成员)、密码(加密存储)
- **项目(Project)**: 代表"用户体验拯救"项目群中的一个项目,包含名称、描述、状态、预算总额、实际花费、开始日期、计划完成日期、创建时间、逾期标识
- **任务(Task)**: 项目下的具体工作项,包含名称、描述、状态、截止日期、负责人(关联到用户)、所属项目(关联到项目)、创建时间、逾期标识
- **花费记录(Expense)**: 项目的支出记录,包含金额、说明、记录时间、所属项目(关联到项目)
- **项目成员关系(ProjectMember)**: 多对多关系,表示哪些用户是哪些项目的成员
- **操作日志(AuditLog)**: 系统操作的审计记录,包含操作时间、操作人(关联到用户)、操作类型、操作对象描述
- **文档链接(DocumentLink)**: 关联到项目或任务的飞书文档链接,包含文档URL、文档标题、关联类型(项目/任务)、关联对象ID、添加人(关联到用户)、添加时间

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 管理员能在3分钟内创建一个新项目,包括设置预算、日期和分配成员
- **SC-002**: 用户能在仪表盘上一眼看到项目群的关键指标(5秒内理解整体状态)
- **SC-003**: 系统能稳定支持至少100个项目和5000个任务的并发访问
- **SC-004**: 任务负责人能在"我的任务"视图中快速找到自己的待办任务(2秒内加载)
- **SC-005**: 管理员能通过操作日志在1分钟内追溯到特定用户的最近操作
- **SC-006**: 预算超支项目能在仪表盘和项目看板上醒目显示,管理员能在5秒内识别出超支项目
- **SC-007**: 逾期项目和任务能自动标识,管理员每日登录时能立即看到逾期警告
- **SC-008**: 90%的日常操作(查看仪表盘、更新任务状态、添加花费记录)能在10秒内完成
- **SC-009**: 新用户在首次登录后能在5分钟内理解系统结构并开始使用(通过清晰的导航和视图)
- **SC-010**: 系统在一年期项目周期内能持续稳定运行,数据完整性保持100%

### Assumptions

- 用户数量在100人以内(总负责人1人 + 核心班子10人 + 总成员10人 + 股东5人 + 项目参与者20人 + 任务负责人30人 + 一些余量)
- 项目数量在100个以内
- 每个项目平均有50个任务
- 系统为内部使用,安全级别为企业内网标准(不需要公网级别的安全加固)
- 用户主要通过桌面浏览器访问(移动端响应式支持为次要优先级)
- 预算币种统一为人民币(元)
- 初始系统不需要与外部系统(财务系统、HR系统)集成
- 操作日志保留完整历史(不自动清理)
- 逾期检查每日凌晨执行一次
- 用户密码策略采用行业标准(最少8位,包含字母和数字)
- 团队使用飞书作为主要协作平台,文档链接指向飞书文档(feishu.cn或larksuite.com域名)
- 文档链接仅存储URL,不同步或缓存飞书文档内容
- 飞书文档的访问权限由飞书平台管理,系统不控制文档访问权限
